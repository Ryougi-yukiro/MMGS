library(MMGS)
library(dplyr)
#读入数据
trait<-read.table(file="E:/10.devR/Trait_records.txt",header=T)
env_info<-read.table(file="E:/10.devR/Env_meta_table.txt",header=T)
PTT_PTR <- read.table(file="E:/10.devR/7Envs_envParas_DAP122.txt", header = T , sep = "\t")
geno <- read.table(file="E:/10.devR/Genotype.txt", header = T , sep = "\t")
env_trait<-env_trait_calculate(data=trait,trait="FTgdd",env="env_code")
LbyE<-LbyE_calculate(data=trait,trait="FTgdd",env="env_code",line="line_code")
envMeanPara<-envMeanPara(data=env_trait, env_paras=PTT_PTR, maxR_dap1=18,
maxR_dap2=43, Paras=Paras)
Paras <- c('DL', 'GDD', 'PTT', 'PTR', 'PTS');
envMeanPara<-envMeanPara(data=env_trait, env_paras=PTT_PTR, maxR_dap1=18,
maxR_dap2=43, Paras=Paras)
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="norm",
model="rrBLUP", fold=2, reshuffle=5, methods="RM.G")
#开始预测 定义你所要输入的表型
pheno<-LbyE[which(as.character(LbyE$line_code)%in%c("line_code",as.character(geno$line_code))),]
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="norm",
model="rrBLUP", fold=2, reshuffle=5, methods="RM.G")
View(out)
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="rrBLUP", fold=2, reshuffle=2, methods="RM.G")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[1]]
out[[2]]
out[[3]]
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[3]]
out[[2]]
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out[[2]]
out[[3]]
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[2]]
out[[3]]
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="EN", fold=2, reshuffle=2, methods="RM.G")
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="EN", fold=2, reshuffle=2, methods="RM.G")
out[[3]]
out[[2]]
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out[[2]]
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[1]]
Prd<-out[[2]]
View(Prd)
Obs<-out[[1]]
View(Obs)
View(Prd)
cor(Obs$PR12,Prd$PR12)
cor(Obs$IA13,Prd$IA13)
