library("MMGS")
MMGP
etl_calculate
library("MMGS")
MMGP
MMGP
MMGP
library("MMGS")
MMGP
library("MMGS")
MMGP
library(MMGS)
MMGP
devtools::install_github("Ryougi-yukiro/MMGS")
MMGP
devtools::install_github("Ryougi-yukiro/MMGS")
library(MMGS)
MMGP
library(MMGS)
devtools::document()
import(RColorBrewer)
importFrom("grDevices", "colorRampPalette", "heat.colors")
library(devtools)
importFrom("grDevices", "colorRampPalette", "heat.colors")
library(MMGS)
?aggregate(. ~ line_code, data = yhat.whole.cross, FUN = mean)
?aggregate
library(MMGS)
?cor
?lm
?median
?subset
?quantile
?scale_color_manual
?colorRampPalette
source("E:/10.devR/MMGS/R/LbyE_corrplot.R")
?cor
?unit
source("E:/10.devR/MMGS/R/mse_plotter.R")
source("E:/10.devR/MMGS/R/Reg_plotter.R")
source("E:/10.devR/MMGS/R/LbyE_corrplot.R")
?predict
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
?dist
?select
?heat.colors
?dist
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
?line_code
？mutate
?mutate
?group_by
?row_number
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
?left_join
library(MMGS)
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
?hclust
#卸除所有已经安装的包
detachAllPackages <- function() {
basic.packages <- c("package:stats","package:graphics","package:grDevices","package:utils","package:datasets","package:methods","package:base")
package.list <- search()[ifelse(unlist(gregexpr("package:",search()))==1,TRUE,FALSE)]
package.list <- setdiff(package.list,basic.packages)
if (length(package.list)>0)  for (package in package.list) detach(package, character.only=TRUE)
}
detachAllPackages()
trait<-read.table(file="E:/10.devR/Trait_records.txt",header=T)
env_info<-read.table(file="E:/10.devR/Env_meta_table.txt",header=T)
PTT_PTR <- read.table(file="E:/10.devR/7Envs_envParas_DAP122.txt", header = T , sep = "\t")
geno <- read.table(file="E:/10.devR/Genotype.txt", header = T , sep = "\t")
library(MMGS)
#读入数据
data(trait)
data(geno)
data(env_info)
data("PTT_PTR")
#数据计算
env_trait<-env_trait_calculate(data=trait,trait="FTgdd",env="env_code")
LbyE<-LbyE_calculate(data=trait,trait="FTgdd",env="env_code",line="line_code")
Paras <- c('DL', 'GDD', 'PTT', 'PTR', 'PTS')
envMeanPara<-envMeanPara(data=env_trait, env_paras=PTT_PTR, maxR_dap1=18,
maxR_dap2=43, Paras=Paras)
pheno<-LbyE[which(as.character(LbyE$line_code)%in%c("line_code",as.character(geno$line_code))),]
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[2]]
out[[1]]
colnames(out[[1]])
colnames(out[[2]])
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[3]]
out[[2]]
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
colnames(out[[1]])
colnames(out[[2]])
cor(out[[1]]$PR12,out[[2]]$PR12)
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
cor(out[[1]]$PR12,out[[2]]$PR12)
colnames(out[[1]])
colnames(out[[2]])
cor(out[[1]]$PR12,out[[2]]$PR12)
dim(out[[1]])
dim(out[[2]])
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
cor(out[[1]]$PR12,out[[2]]$PR12)
cor(out[[1]]$PR11,out[[2]]$PR11)
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="EN", fold=2, reshuffle=2, methods="RM.G")
cor(out[[1]]$PR12,out[[2]]$PR12)
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
column_order <- colnames(out[[1]])
out[[2]] <- out[[2]] %>%
select(column_order)
out[[2]] <- out[[2]] %>% select(column_order)
out[[2]]
head(out[[2]]）
head(out[[2]])
head(out[[1]])
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="EN", fold=2, reshuffle=2, methods="RM.G")
out[[2]]
out[[3]]
source("E:/10.devR/MMGS/R/Cross_vadiation.R")
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="EN", fold=2, reshuffle=2, methods="RM.G")
out[[2]]
out[[3]]
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[3]]
out[[2]]
library(MMGS)
prdM <- LOOCV(maxR_dap1=22,maxR_dap2=35,data=filtered_trait,input=env_trait,env_paras=PTT_PTR,
Para_Name="PTS",trait="PH",line="line_code",p=1,filter=4)
prdM <- LOOCV(maxR_dap1=22,maxR_dap2=35,data=trait,input=env_trait,env_paras=PTT_PTR,
Para_Name="PTS",trait="PH",line="line_code",p=1,filter=4)
prdM <- LOOCV(maxR_dap1=18,maxR_dap2=43,data=trait,input=env_trait,env_paras=PTT_PTR,
Para_Name="PTT",trait="PH",line="line_code",p=1,filter=4)
prdM <- LOOCV(maxR_dap1=18,maxR_dap2=43,data=trait,input=env_trait,env_paras=PTT_PTR,
Para_Name="PTT",trait="FTgdd",line="line_code",p=1,filter=4)
View(prdM)
prdM_plotter(prdM=prdM,data=envMeanPara,trait="FTgdd",Para_Name="PTT");
envMeanPara_plotter(input=envMeanPara,paras="PTT")
?envMeanPara_plotter
envMeanPara_plotter(envMeanPara=envMeanPara,paras="PTT")
envMeanPara_plotter(envMeanPara=envMeanPara)
Reg<-Reg(LbyE=LbyE,env_trait=env_trait)
#出图
Reg_plotter(Reg=Reg)
Mean_trait_plot(Reg,MSE)
result<-line_trait_mean(data=trait,trait="FTgdd",mean=env_trait,LbyE=LbyE,row=2)
MSE<-result[[1]]
ltm<-result[[2]]
mse_plotter(MSE)
Mean_trait_plot(Reg,MSE)
LbyE_corrplot(LbyE=LbyE)
?LbyE_corrplot
LbyE_corrplot(LbyE=LbyE,cor_type="pie")
LbyE_corrplot(LbyE=LbyE,cor_type="heatmap")
#数据计算
env_trait<-env_trait_calculate(data=trait,trait="FTgdd",env="env_code")
LbyE<-LbyE_calculate(data=trait,trait="FTgdd",env="env_code",line="line_code")
#环境相关性计算
LbyE_corrplot(LbyE=LbyE,cor_type="heatmap")
LbyE_corrplot(LbyE=LbyE,cor_type="pie")
etl<-etl_calculate(data=env_info,trait="FTgdd",env="env_code",bycol="lat")
#出图
etl_plotter(data=etl,mean=env_trait)
out<-MMGP(pheno=pheno, geno=geno, env=env_info,
para=envMeanPara, Para_Name="PTT", depend="Marker",
model="GBM", fold=2, reshuffle=2, methods="RM.G")
out[[2]]
out[[3]]
R2<-as.data.frame(out[[3]])
r2
R2
ggplot(out[[3]], aes(x=out[[3]], y=out[[3]]))
ggplot(R2 aes(x=out[[3]], y=out[[3]]))
ggplot(R2,aes(x=out[[3]], y=out[[3]]))
R2<-as.data.frame(R2="R2",value=out[[3]])
R2\
R2
###Test区
library(MMGS)
#读入数据
data(trait)
data(geno)
data(env_info)
data("PTT_PTR")
library(MMGS)
Trait<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/traits_ori",header=T)
View(Trait)
Trait<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Trait_records.txt",header=T)
GENO<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Genotype.txt",header=T)
View(GENO)
View(Trait)
library(MMGS)
Trait<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Trait_records.txt",header=T)
GENO<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Genotype.txt",header=T)
PTT_PTR<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/9Envs_envParas_DAP80",header=T)
library(MMGS)
Trait<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Trait_records.txt",header=T)
GENO<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Genotype.txt",header=T)
PTT_PTR<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/9Envs_envParas_DAP80.txt",header=T)
View(PTT_PTR)
library(MMGS)
Trait<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Trait_records.txt",header=T)
GENO<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Genotype.txt",header=T)
PTT_PTR<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/9Envs_envParas_DAP80.txt",header=T)
env_info<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Env_meta_table.txt",header=T)
env_info<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Env_meta_table.txt",sep="\t",header=T)
View(env_info)
View(Trait)
library(MMGS)
Trait<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Trait_records.txt",header=T)
GENO<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Genotype.txt",header=T)
PTT_PTR<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/8Envs_envParas_DAP80.txt",header=T)
env_info<-read.table(file="C:/Users/z9809/Desktop/水稻benchmark/Env_meta_table.txt",sep="\t",header=T)
library(MMGS)
Trait<-read.table(file="C:/Users/z9809/Desktop/Maizebenchmark/Trait_records.txt",header=T)
